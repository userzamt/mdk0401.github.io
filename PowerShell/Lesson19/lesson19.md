# Урок 19. Поток управления

[На главную](/mdk0401.github.io)

Одним из основных преимуществ работы с переменными является возможность писать с их помощью код, который работает не со значением, а со *«смыслом»*. Вместо того чтобы работать, например, с числом 3, мы работаем с общим понятием *$serverCount*. За счет этого мы можем писать код, который работает одинаково, будь у вас один, два или тысяча серверов. Совместите эту способность с возможностью сохранять код в сценариях, которые можно запускать на разных компьютерах, и вы сможете начать решать задачи гораздо большего масштаба. Однако в жизни порой имеет значение, работаете ли вы с одним сервером, с двумя или с тысячей. Пока что у вас нет подходящего способа учитывать это, и ваши сценарии работают просто *«сверху вниз»*, не имея возможности адаптироваться в зависимости от определенных значений. В этой части будет рассматриваться поток управления и условная логика для написания сценариев, которые будут выполнять различные команды в зависимости от значений, с которыми они работают, а также будут рассмотрены различные циклы.

## Операторы сравнения 
Операторы сравнения позволяют сравнивать значения параметров в командах. При каждой операции сравнения создается условие, в зависимости от выполнения или невыполнения которого оператор принимает либо значение `$True` (истина), либо значение `$False` (ложь). В `PowerShell` поддерживается несколько операторов сравнения, причем для каждого такого оператора определены версии, учитывающие и не учитывающие регистр букв. 

| Оператор | Значение | Пример (возвращается значение $true)| 
| :--: | :-- | :--: | 
| -eq –ceq –ieq | равно | 10 -eq 10| 
| -ne –cne –ine | не равно | 9 -ne 10| 
| -lt –clt –ilt | меньше | 3 -lt 4| 
| -le –cle –ile | меньше или равно | 3 –le 4| 
| -gt –cgt –igt | больше | 4 -gt 3| 
| -ge –cge –ige | больше или равно | 4 -ge 3| 
| -contains -ccontains -icintains | содержит | 1,2,3 –contains 1| 
| -notcontains -cnotcontains -inotcontains | не содержит | 1,2,3 –notcontains 4| 

Базовый вариант операторов сравнения (`-eq`, `-ne`, `-lt` и т. д.) по умолчанию **не учитывает регистр букв**. Если оператор начинается с буквы *"c"* (`-ceq`, `-cne`, `-clt` и т. д.), то при сравнении **регистр букв будет приниматься во внимание**. Если оператор начинается с буквы *"i"* (`-ieq`, `-ine`, `-ilt` и т. д.), то регистр букв при сравнении не учитывается. 

> [!IMPORTANT]
> В `PowerShell` для обозначения операторов сравнения не используются обычные символы `>` и `<`, так как они зарезервированы для перенаправления ввода/вывода. 

Для операторов сравнения справедливо *"правило левой руки"*(определяющим является **тип левого операнда**). Если число сравнивается со строкой (число стоит слева от оператора сравнения), то строка преобразовывается в число и выполняется сравнение двух чисел. Если левый операнд является строкой, то правый операнд преобразуется к символьному типу и выполняется сравнение двух строк.

Если левым операндом является массив, то оператор сравнения будет возвращать те элементы этого массива, которые соответствуют правому операнду

```powershell
 1,23,4,5,6 -gt 4
```

## Операторы проверки на соответствие шаблону
Наряду с основными операторами сравнения в `PowerShell` имеются операторы проверки символьных строк на соответствие определенному шаблону.

При этом поддерживаются два вида шаблонов: выражения с подстановочными символами и регулярные выражения.

```powershell
ls p*
ls ?*pp*
```

> [!NOTE]
> `*` - любое количество произвольных символов. `?` - один произвольный символ

## Логические операторы 
Иногда внутри одной инструкции необходимо проверить сразу несколько условий. Операторы сравнения можно соединять друг с другом с помощью логических операторов. 

При использовании логического оператора `PowerShell` проверяет каждое условие отдельно, а затем вычисляет значение инструкций целиком, связывая условия при помощи логических операторов. 

| Оператор | Значение | Пример (возвращается значение $True)| 
| :--: | :-- | :--: | 
| -and | логическое И | (10 -eq 10) –and (1 –eq 1) | 
| -or | логическое ИЛИ | (9 -ne 10) –or (3 –eq 4) | 
| -not | логическое НЕ | -not (3 –gt 4) | 
| ! | логическое НЕ | !(3 -gt 4)| 

## Инструкция If … ElseIf … Else 
Логические сравнения лежат в основе практически всех алгоритмических языков программирования. В `PowerShell` при помощи инструкции `If` можно выполнять определенные блоки кода только в том случае, когда заданное условие имеет значение `$True` (истина). 

Также можно задать одно или несколько дополнительных условных блоков. Соответствующие им условия будут проверяться, если все предыдущие условия имели значение `$False`. Наконец, можно задать дополнительный блок кода, который будет выполняться в том случае, если ни одно из условий не имеет значения `$True`.

```powershell
$age = Read-Host "Сколько Вам лет? "

if ($age -lt 12) {
    Write-Error "Доступ строго воспрещён"
} elseif ($age -lt 16) {
    Write-Warning "Запрещено"
} else {
    Write-Host "Добро пожаловать"
}
```
