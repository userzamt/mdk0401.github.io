# ПР12 Парсинг CSV-файлов

[На главную](/mdk0401.github.io)

## Создание CSV-файла
Написать скрипт, который производит анализ локальной сети на наличие активных хостов(ПК). Основываясь на маске подсети для Вашего сетевого интерфейса, произвести опрос всех возможных IP-адресов в данной подсети. Опрос производить с помощью командлета `Test-Connection`

```powershell
Test-Connection 10.207.106.12 -Count 1 -Quiet
```

> [!NOTE]
> `-Count` указывает количество пакетов для отправке хосту
> `-Quiet` при использовании данного ключа командлет возвращает булево значение True/False

Все активные IP-адреса записать в CSV-файл. Так же для IP-адресов, используя командлет `Resolve-DnsName`, найти их DNS-имена.

```powershell
Resolve-DnsName -Name 10.207.106.12 -Type PTR -ErrorAction SilentlyContinue
```

> [!NOTE]
> `-Type PTR` при указании данного параметра со значением *PTR* позволяет преобразовать IP-адрес в DNS-имя
> `-ErrorAction SilentlyContinue` при указании данного параметра со значением *SilentlyContinue* блокирует вывод сообщений об ошибки в консоль и продолжает работу скрипта

Найденные пары IP-адрес и DNS-имя хоста сохранить в CSV-файл с разделителем запятая `,`

```
host, ip
srvr-06.zamt.local,10.207.106.6
srvr-dc01.zamt.local,10.207.106.11
srvr-web.zamt.local,10.207.106.12
...
```

## Инвентаризация 
Используя полученный ранее CSV-файл произвести опрос хостов по DNS-именам. 

Допускается написать отдельный скрипт или конвейер из командлетов.

## JSON
[The Star Wars API](https://swapi.dev/documentation)
Используя сторонний REST API выполнить простой запрос к серверу и произвести анализ полученных данных в формате JSON. Полученные данные вывести в удобном для пользователя виде.

Запрос производить с помощью командлета `Invoke-WebRequest`

```powershell
Invoke-WebRequest https://swapi.dev/api/ -UseBasicParsing
```
