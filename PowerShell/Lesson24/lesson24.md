# Урок 24. Обработка ошибок

[На главную](/mdk0401.github.io)

При применении сценариев для решения реальных администраторских задач (например, для управления учетными записями пользователей, резервного копирования информации на серверах, анализа журналов событий с целью выявления попыток несанкционированного доступа в систему и т. п.) весьма актуальной становится обработка возможных ошибок или исключительных ситуаций. Нужно быть уверенным, что определенная задача выполнена полностью, а в случае возникновения ошибки проанализировать и устранить ее. Язык PowerShell предлагает несколько механизмов обработки ошибок.

Кроме того, в оболочке PowerShell имеются средства отладки сценариев, помогающие находить ошибки в программном коде, а также анализировать ход выполнения сценариев и состояние системы при этом.

## Обработка ошибок
Возникновение ошибки при выполнении команды PowerShell приводит не только к выводу текстовых сообщений на экран, а еще и к автоматическому созданию настоящего **объекта**, в свойствах которого содержится полная информация о данной ошибке. Один аспект обработки ошибок в PowerShell отличает эту систему от других языков программирования: ошибки здесь могут быть *"критическими"* (прерывающими выполнение команды) и *"некритическими"* (при их возникновении выполнение команды продолжается). Это связано с тем, что для обработки объектов в PowerShell используется модель конвейера команд. 

При возникновении *"некритической"* ошибки информация о ней записывается в соответствующий объект, а текущая команда **продолжает обрабатывать** поступающие к ней по конвейеру объекты. 

Подобная ошибка может возникнуть, например, при копировании с помощью командлета множества файлов, один из которых оказался занят другим приложением. В таком случае логично продолжить копирование остальных файлов. 

Если же выполняется какая-то важная и логически неделимая операция, то может иметь смысл остановить ее после возникновения первой ошибки (тогда подобная ошибка будет *"критической"*). 

**При этом одна и та же ошибка в одной ситуации должна считаться *"критической"*, а в другой — *"некритической"*.** 

Поэтому в PowerShell встроен механизм, позволяющий явно задавать эти типы для ошибок. При возникновении *"некритических"* ошибок информация о них помещается в объекты типа `ErrorRecord`, которые записываются в специальный поток ошибок.

```powershell
Get-Service bits,foo,lanmanserver
```





