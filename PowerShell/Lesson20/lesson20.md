# Урок 20. Функции в PowerShell

[На главную](/mdk0401.github.io)

До настоящего момента мы работали преимущественно со стандартными скомпилированными командлетами, функциональность которых нельзя изменить, так как их исходный код в оболочке `PowerShell` недоступен. **Функции и сценарии** — это два других типа команд `PowerShell`, которые можно создавать и изменять по своему усмотрению, пользуясь языком `PowerShell`. 

> [!NOTE] 
> Следует сразу обратить внимание, что функции в `PowerShell` **имеют некоторые особенности** по сравнению с функциями в традиционных языках программирования, так как `PowerShell` — это в первую очередь оболочка. 

`PowerShell` **функция — это команда**. Отсюда различие в способах вызова функций и передачи им аргументов. Обычно функции в традиционных языках возвращают единственное значение того или иного типа. *"Значением"* функции `PowerShell` может быть целый массив различных объектов, так как каждое вычисляемое в функции выражение помещает свой результат в выходной поток. Кроме того, функции в `PowerShell` делятся на несколько типов согласно их поведению внутри конвейера команд. 

**Функция** в `PowerShell` — это блок кода, имеющий название и находящийся в памяти до завершения текущего сеанса командной оболочки.

```powershell
function Verb-Noun {
   # code
}
```

Если функция определяется без формальных параметров, то для ее задания достаточно указать ключевое слово `Function`, затем имя функции и список выражений,  составляющих тело функции (данный список должен быть заключен в фигурные скобки).

```powershell
function Get-MyPSVersion {
    $PSVersionTable.PSVersion
}
```

После загрузки в память её можно найти

```powershell
Get-Command -CommandType Function

Get-PSDrive
Get-ChildItem Function:\Get-MyPSVersion
```

