# Урок 23. Удаленный запуск сценариев

[На главную](/mdk0401.github.io)

Если вы единственный ИТ-специалист в небольшой организации, скорее всего, вы ответственны за несколько серверов. Когда у вас есть сценарий, который необходимо запустить, вы заходите на каждый сервер, открываете консоль PowerShell и запускаете его. Однако можно сэкономить кучу времени, если запустить всего один сценарий, который будет выполнять определенную задачу на каждом сервере. 

В этой лекции мы рассмотрим, как удаленно запускать команды с помощью инструментов PowerShell. 

**Удаленное управление PowerShell** — это инструмент, который позволяет пользователю удаленно запускать команды на одном или нескольких компьютерах одновременно. 

Сеанс, или, если точнее, сеанс `PSSession`, — это взаимодействие со средой PowerShell, запущенной на удаленном компьютере, с которого вы можете выполнять команды. 

> [!NOTE]
> Сотрудники корпорации Microsoft внедрили удаленное управление в версии *PowerShell v2*. Оно было создано на основе службы *Windows Remote Management (WinRM)*. По этой причине удаленное управление PowerShell иногда ассоциируют с термином **WinRM**.

Но прежде, поговорим о...

<!-- TODO необходимо проверить -->
## Удаленное взаимодействие с Windows PowerShell без настройки
Многие командлеты Windows PowerShell имеют параметр `ComputerName`, который позволяет собирать данные и изменять параметры одного или нескольких удаленных компьютеров. Эти командлеты используют разные протоколы связи и работают во всех операционных системах Windows без специальной настройки.

В эти командлеты входят следующие:

+ `Restart-Computer`
+ `Test-Connection`
+ `Clear-EventLog`
+ `Get-EventLog`
+ `Get-HotFix`
+ `Get-Process`
+ `Get-Service`
+ `Set-Service`
+ `Get-WinEvent`
+ `Get-WmiObject`

Обычно командлеты, которые поддерживают удаленное взаимодействие без специальной настройки, имеют параметр `ComputerName`, но не имеют параметра `Session`. Чтобы найти эти командлеты в сеансе, используйте следующую команду:

```powershell
Get-Command | Where-Object {
    $_.Parameters.Keys -contains "ComputerName" -and
    $_.Parameters.Keys -notcontains "Session"
}
```


