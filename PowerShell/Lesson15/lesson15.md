# Урок 15. PowerShell. Основные понятия

[На главную](/mdk0401.github.io)

**PowerShell** – это язык сценариев и командная оболочка Windows, которые разработаны для администрирования и конфигурирования операционных систем Windows.

*Для чего, собственно, компании Microsoft потребовалось создавать этот совершенно новый инструмент и язык программирования?*

*Какую пользу он может принести обычным пользователям и системным администраторам?*

*Почему недостаточно было существующих средств?*

## Предшественники PowerShell
В настоящее время графический интерфейс Windows стал настолько привычным, что многие пользователи и начинающие администраторы даже не задумываются об альтернативных способах управления операционной системой с помощью командной строки (*command line*) и различных сценариев (*scripts*). Зачастую они просто не знают о тех преимуществах, которые дают эти инструменты с точки зрения автоматизации работы.

Компания Microsoft изначально ориентировалась на широкую аудиторию неискушенных пользователей, не желающих особо вникать в технические детали выполнения тех или иных действий в системе. Поэтому основные усилия разработчиков операционной системы направлялись на улучшение графической оболочки для более комфортной работы непрофессионалов, а не на создание рабочей среды для специалистов или опытных пользователей.

Однако подобная модель управления не является масштабируемой: если с помощью стандартных графических инструментов администрировать не один, а десять серверов, то последовательность изменений настроек в диалоговых окнах придется повторить десять раз. Следовательно, в этом случае остро встает вопрос об автоматизации выполнения рутинных операций (например, проведения инвентаризации оборудования и программного обеспечения, мониторинга работы служб, анализа журналов событий и т.д.) на множестве компьютеров.

В UNIX-системах в качестве инструмента автоматизации выступает стандартная оболочка (*sh*) или ее модификации (*bash*, *ksh*, *csh* и т. д.). 

В операционной системе Windows дело **обстоит сложнее**. На сегодняшний день одного "идеального" средства автоматизации, удовлетворяющего сразу всем требованиям, в Windows нет. 

В последних версиях операционной системы одновременно поддерживаются несколько стандартных инструментов автоматизации, сильно отличающихся друг от друга: 

+ оболочка командной строки `cmd.exe`
+ среда выполнения сценариев **Windows Script Host (WSH)**
+ оболочка **WMI Command-line (WMIC)**
+ оболочка **Microsoft PowerShell**

## Оболочка командной строки command.com/cmd.exe
Во всех версиях операционной системы Windows поддерживается интерактивная оболочка командной строки (command shell / `command.com`), и по умолчанию устанавливается определенный набор утилит командной строки. 

> [!NOTE]
> Вообще, любую операционную систему можно представить в виде совокупности ядра системы, которое имеет доступ к аппаратуре и управляет файлами и процессами, и оболочки (командного интерпретатора) с утилитами, которые позволяют пользователю получить доступ к функциональности ядра операционной системы. 

Наряду с интерактивным режимом работы, оболочка  поддерживает и пакетный режим, в котором система последовательно выполняет команды, записанные в текстовом файле-сценарии - **Batch скрипт**. 

Начиная с версии Windows NT, оболочка командной строки представляется интерпретатором `cmd.exe`, который расширяет возможности оболочки `command.com` операционной системы MS-DOS. 

В свою очередь функциональность командного интерпретатора `command.com` была позаимствована из операционной системы CP/M, командный интерпретатор которой представлял собой значительно упрощенный и урезанный вариант оболочки UNIX-систем. 

Таким образом, оболочка командной строки MS-DOS изначально уступала UNIX-оболочкам по удобству работы и развитости языка сценариев. 

В командной оболочке Windows NT (cmd.exe), несмотря на все сделанные улучшения, не удалось преодолеть данное отставание ни в режиме интерактивной работы (например, в cmd.exe отсутствует поддержка псевдонимов для длинных названий команд и не реализовано автоматическое завершение команд при вводе их с клавиатуры), ни в синтаксисе или возможностях языка командных файлов. 

Ситуация усугублялась тем, что Windows всегда проигрывала UNIX-системам в количестве и функциональных возможностях стандартных (не требующих дополнительной установки) утилит командной строки, а также в качестве и полноте встроенной справочной системы по командам оболочки. 

Оболочка командной строки `cmd.exe` и командные файлы — наиболее универсальные и простые в изучении средства автоматизации работы в Windows, доступные во всех версиях операционной системы.

При этом оболочка `cmd.exe` и командные файлы существенно проигрывают аналогичным инструментам в UNIX-системах и не обеспечивают доступ к объектным моделям, поддерживаемым операционной системой (COM, WMI, .NET). 
